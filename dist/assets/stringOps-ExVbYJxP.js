import{u}from"./executor-D39oo3pD.js";import{g}from"./index-CpYWmskZ.js";const{unwrapData:o}=u,p=10*1024*1024;function l(t,e){const r=String(t);if(r.length>p)throw new Error(`String too large for ${e} operation (max ${p} bytes)`);return r}function f({nodeData:t,inputs:e}){const r=l(o(e.a),"concat"),a=l(o(e.b),"concat"),n=r+a;if(n.length>p)throw new Error("Concatenated string exceeds maximum length");return n}function h({nodeData:t,inputs:e}){const r=l(o(e.input),"split"),a=l(o(e.separator),"split"),n=r.split(a),c=1e5;if(n.length>c)throw new Error(`Split would create too many parts (max ${c})`);return n}function m({nodeData:t,inputs:e}){const r=l(o(e.input),"replace"),a=l(o(e.search),"replace"),n=l(o(e.replace),"replace"),c=g(a),s=()=>r.replace(new RegExp(c,"g"),n);try{return s()}catch(i){throw new Error(`Replace operation failed: ${i.message}`)}}function w({nodeData:t,inputs:e}){const r=t.templateString||"",a=/\{([^}]+)\}/g;let n=r,c;for(;(c=a.exec(r))!==null;){const s=c[1],i=o(e[s]);i!=null&&(n=n.replace(`{${s}}`,String(i)))}return n}function x({nodeData:t,inputs:e}){const r=t.operation||"concat";switch(r){case"concat":return f({nodeData:t,inputs:e});case"split":return h({nodeData:t,inputs:e});case"replace":return m({nodeData:t,inputs:e});case"template":return w({nodeData:t,inputs:e});default:throw new Error(`Unknown string operation: ${r}`)}}function v(t){const e=["concat","split","replace","template"];return!t.operation||!e.includes(t.operation)?{valid:!1,errors:["Invalid operation"]}:t.operation==="template"&&!t.templateString?{valid:!1,errors:["Template string is required"]}:{valid:!0,errors:[]}}export{x as execute,f as stringConcat,m as stringReplace,h as stringSplit,w as stringTemplate,v as validate};
