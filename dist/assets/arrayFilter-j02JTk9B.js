import{u as w}from"./executor-D39oo3pD.js";import{g as d}from"./pathUtils-C9hlO1xX.js";import"./index-CpYWmskZ.js";const{unwrapData:h}=w;function y(e,r="iso"){if(!e)return null;try{switch(r){case"iso":case"iso-datetime":const o=new Date(e);return isNaN(o.getTime())?null:o;case"br":if(typeof e!="string")return null;const u=e.split("/");if(u.length!==3)return null;const[l,t,s]=u,i=new Date(`${s}-${t.padStart(2,"0")}-${l.padStart(2,"0")}`);return isNaN(i.getTime())?null:i;case"us":if(typeof e!="string")return null;const n=e.split("/");if(n.length!==3)return null;const[f,a,c]=n,p=new Date(`${c}-${f.padStart(2,"0")}-${a.padStart(2,"0")}`);return isNaN(p.getTime())?null:p;case"timestamp":const g=Number(e);if(isNaN(g))return null;const m=new Date(g);return isNaN(m.getTime())?null:m;default:const N=new Date(e);return isNaN(N.getTime())?null:N}}catch{return null}}function b(e,r,o,u="auto",l="iso"){let t=e,s=r;if(u==="date"){const i=y(e,l),n=y(r,l);if(!i||!n)return!1;t=i.getTime(),s=n.getTime()}else if(u==="number"){if(t=Number(e),s=Number(r),isNaN(t)||isNaN(s))return!1}else if(u==="boolean"){const i=n=>{if(typeof n=="boolean")return n;if(typeof n=="number")return n!==0;if(typeof n=="string"){const f=n.toLowerCase();return f==="true"||f==="yes"||f==="1"}return!!n};t=i(e),s=i(r)}else if(u==="string")t=String(e),s=String(r);else if(u==="auto"){const i=Number(e),n=Number(r);!isNaN(i)&&!isNaN(n)?(t=i,s=n):(t=String(e),s=String(r))}switch(o){case"equals":return t===s;case"notEquals":return t!==s;case"greaterThan":return t>s;case"lessThan":return t<s;case"greaterOrEqual":return t>=s;case"lessOrEqual":return t<=s;case"contains":return String(t).toLowerCase().includes(String(s).toLowerCase());case"startsWith":return String(t).toLowerCase().startsWith(String(s).toLowerCase());case"endsWith":return String(t).toLowerCase().endsWith(String(s).toLowerCase());default:return!0}}function E({nodeData:e,inputs:r}){console.log("üîç DEBUG arrayFilter - inputs:",r),console.log('üîç DEBUG arrayFilter - inputs["data-input"]:',r["data-input"]);let o=h(r["data-input"]);if(console.log("üîç DEBUG arrayFilter - inputData after unwrap:",o),console.log("üîç DEBUG arrayFilter - Array.isArray(inputData):",Array.isArray(o)),!Array.isArray(o))throw new Error("Input deve ser um array");const u=e.fieldMode||"selector";let l;if(u==="custom")l=e.customField;else{const a=e.selectedField;Array.isArray(a)&&a.length>0?l=a[0]:typeof a=="string"&&(l=a)}const t=e.operator||"equals",s=r["exposed-value"]!==void 0?h(r["exposed-value"]):e.value,i=e.comparisonType||"auto",n=e.dateFormat||"iso";return t==="exists"?o.filter(a=>{const c=d(a,l);return c!=null}):t==="notExists"?o.filter(a=>{const c=d(a,l);return c==null}):o.filter(a=>{const c=d(a,l);return c==null?!1:b(c,s,t,i,n)})}function C(e){const r=[];return(e.fieldMode||"selector")==="custom"?e.customField||r.push("Campo customField obrigat√≥rio no modo custom"):(!e.selectedField||Array.isArray(e.selectedField)&&e.selectedField.length===0)&&r.push("Sele√ß√£o de campo obrigat√≥ria"),e.operator||r.push('Campo "operator" obrigat√≥rio'),["equals","notEquals","greaterThan","lessThan","greaterOrEqual","lessOrEqual","contains","startsWith","endsWith"].includes(e.operator)&&!e.value&&r.push(`Operador "${e.operator}" requer um valor de compara√ß√£o`),{valid:r.length===0,errors:r}}export{E as execute,C as validate};
